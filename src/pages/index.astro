---
import Arrow from '@/components/arrow.astro';
import { buttonVariants } from '@/components/button.astro';
import Link from '@/components/link.astro';
import * as List from '@/components/list';
import Separator from '@/components/separator.astro';
import Text from '@/components/text.astro';
import Layout from '@/layouts/index.astro';
import { getSortedPosts } from '@/libs/content';
import PostCard from '@/pages/components/_post-card.astro';
import ProjectCard from '@/pages/components/_project-card.astro';
import { getCollection } from 'astro:content';
import * as env from 'astro:env/server';

const posts = await getSortedPosts();
const projects = await getCollection('projects');
const socialIconButton = buttonVariants({ variant: 'ghost', size: 'icon' });
---

<Layout class="counter-root mx-auto flex w-full max-w-4xl flex-col gap-20">
  <section>
    <Text as="h1" size="11" weight="bold" class="not-sm:text-4xl">CHRISTIAN PENROD</Text>
    <Text as="h2" size="9" class="not-sm:text-3xl">Front-End Web Developer</Text>
    <Text variant="subtle" class="my-6 not-sm:text-xs">
      Working on the web since 2018. I enjoy developing efficient web experiences through code and design.
      {env.JOB_TITLE} at <Link href={env.JOB_LINK} class="not-sm:text-xs">{env.JOB_NAME}</Link>.
      {env.COLLEGE_TITLE} graduate from <Link href={env.COLLEGE_LINK} class="not-sm:text-xs">{env.COLLEGE_NAME}</Link>.
    </Text>
    <List.Root orientation="horizontal">
      <List.ItemLink href={env.GITHUB} icon="github" aria-label="Github" class={socialIconButton} />
      <List.ItemLink href={env.TWITTER} icon="arcticons:x-twitter" aria-label="Twitter/X" class={socialIconButton} />
      <List.ItemLink href={env.BLUESKY} icon="arcticons:bluesky" aria-label="Bluesky" class={socialIconButton} />
      <List.ItemLink href={env.LINKEDIN} icon="linkedin" aria-label="LinkedIn" class={socialIconButton} />
      <List.ItemLink href={`mailto:${env.EMAIL}`} icon="mail" aria-label="Email" class={socialIconButton} />
    </List.Root>
  </section>
  <section class="flex flex-col">
    <Text as="h2" size="5" weight="bold" class="counter-item">PROJECTS SHOWCASE</Text>
    <Text variant="subtle" class="not-sm:text-xs">I work with various web-based projects on the side.</Text>
    <Separator class="mt-4 mb-10" />
    <!-- prettier-ignore -->
    <List.Root class="grid gap-6 md:grid-cols-2">
      {projects.map((project) => (<List.Item><ProjectCard {...project} /></List.Item>))}
    </List.Root>
    <Link href={env.GITHUB} size="2" class="mt-8 self-end">View Github Repo</Link>
  </section>
  <section class="flex flex-col">
    <Text as="h2" size="5" weight="bold" class="counter-item">RECENTLY PUBLISHED</Text>
    <Text variant="subtle" class="not-sm:text-xs">I write about web development and developer experience tooling.</Text>
    <Separator class="mt-4 mb-10" />
    <!-- prettier-ignore -->
    <List.Root class="grid gap-6 md:grid-cols-3">
      {posts.slice(0, 3).map((post) => (<List.Item><PostCard {...post} /></List.Item>))}
    </List.Root>
    <Link href="/blog" size="2" class="mt-8 self-end">View All Posts <Arrow name="right" /></Link>
  </section>
</Layout>
